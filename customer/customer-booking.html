<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="icon" type="image" href="../img/logo">
    <link rel="stylesheet" href="../styles/customer-booking.css">
    <title>Booking System</title>
</head>

<body>
    <div class="container">
        <!-- Category Screen -->
        <div id="categoryScreen">
            <div class="card">
                <div class="header">
                    <h1>Booking</h1>
                </div>
                <div class="content">
                    <h2 class="select-title">Select category:</h2>
                    <div class="categories-grid">
                        <div class="category-option selected" onclick="selectCategory(this, 'Hardware')">
                            <div class="category-icon"><img src="../img/chip.png" alt=""></div>
                            <div class="category-info">
                                <div class="category-name">Hardware</div>
                                <div class="category-desc">Troubleshooting, installing, and computer repairs</div>
                            </div>
                            <div class="radio-circle"></div>
                        </div>
                        <div class="category-option" onclick="selectCategory(this, 'Plumbing')">
                            <div class="category-icon"><img src="../img/repairing.png" alt=""></div>
                            <div class="category-info">
                                <div class="category-name">Plumbing</div>
                                <div class="category-desc">Leaks, installations, and pipe repairs</div>
                            </div>
                            <div class="radio-circle"></div>
                        </div>
                        <div class="category-option" onclick="selectCategory(this, 'Electrical')">
                            <div class="category-icon"><img src="../img/flash.png" alt=""></div>
                            <div class="category-info">
                                <div class="category-name">Electrical</div>
                                <div class="category-desc">Wiring, outlets, and fixture installations</div>
                            </div>
                            <div class="radio-circle"></div>
                        </div>
                    </div>
                    <button class="continue-button" onclick="showRepairers()">Continue</button>
                </div>
            </div>
        </div>

        <!-- Repairers Screen -->
        <div id="repairersScreen" class="hidden">
            <div class="card">
                <div class="header">
                    <div class="header-with-back">
                        <button class="back-button" onclick="showCategories()"><img src="../img/arrow.png" alt=""></button>
                        <h1>Booking</h1>
                    </div>
                </div>

                <div class="filter-buttons">
                    <button class="filter-btn active" onclick="filterRepairers('Most Relevant')">Most Relevant</button>
                    <button class="filter-btn" onclick="filterRepairers('Top Rated')">Top Rated</button>
                    <button class="filter-btn" onclick="filterRepairers('Available')">Available</button>
                </div>

                <div class="category-section" data-category="Hardware">
                    <div class="section-header">
                        <div class="triangle"></div>
                        <h3 class="section-title">Hardware</h3>
                    </div>
                    <div class="section-content">

                        <div class="repairer-card-item">
                            <img src="../img/luis.jpg" alt="Luis Fernando" class="repairer-photo">
                            <div class="repairer-details">
                                <div class="repairer-name">Luis Fernando</div>
                                <div class="repairer-category">Hardware</div>
                                <div class="repairer-rating">Rate: 4.0</div>
                            </div>
                            <button class="book-btn" onclick="openBookingModalFromCard(this)">Book</button>
                        </div>
                    </div>
                </div>

                <div class="category-section hidden" data-category="Plumbing">
                    <div class="section-header">
                        <div class="triangle"></div>
                        <h3 class="section-title">Plumbing</h3>
                    </div>
                    <div class="section-content">
                        <div class="repairer-card-item">
                            <img src="../img/Jose.png" alt="Jose Mari" class="repairer-photo">
                            <div class="repairer-details">
                                <div class="repairer-name">Jose Mari</div>
                                <div class="repairer-category">Plumbing</div>
                                <div class="repairer-rating">Rate: 4.7</div>
                            </div>
                            <button class="book-btn" onclick="openBookingModalFromCard(this)">Book</button>
                        </div>
                    </div>
                </div>

                <div class="category-section hidden" data-category="Electrical">
                    <div class="section-header">
                        <div class="triangle"></div>
                        <h3 class="section-title">Electrical</h3>
                    </div>
                    <div class="section-content">
                        <div class="repairer-card-item">
                            <img src="../img/Juan.png" alt="Juan Dela Cruz" class="repairer-photo">
                            <div class="repairer-details">
                                <div class="repairer-name">Juan Dela Cruz</div>
                                <div class="repairer-category">Electrical</div>
                                <div class="repairer-rating">Rate: 4.5</div>
                            </div>
                            <button class="book-btn" onclick="openBookingModalFromCard(this)">Book</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- BOOKING MODAL -->
        <div class="modal-overlay" id="bookingModal">
            <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="bookTitle">
                <div class="modal-header">
                    <button class="modal-back-button" onclick="closeModal('bookingModal')"><img src="../img/arrow.png" alt=""></button>
                    <h2 class="modal-title" id="bookTitle">Book</h2>
                </div>

                <div class="modal-body">
                    <div class="modal-repairer-info">
                        <img src="" alt="" class="modal-repairer-photo" id="modalRepairerPhoto">
                        <div class="modal-repairer-details">
                            <div class="modal-repairer-name" id="modalRepairerName">Luis Fernando</div>
                            <div class="modal-repairer-category" id="modalRepairerCategory">Hardware</div>
                            <div class="modal-repairer-rating" id="modalRepairerRating">Rate: 4.0</div>
                        </div>
                        <button class="modal-book-btn" id="modalBookBtn" disabled style="opacity:0.5; cursor:not-allowed;">Book</button>
                    </div>

                    <div class="base-service-section">
                        <div class="base-service-title">Base Service Fee</div>
                        <div class="base-service-price" id="baseServicePrice">500 PHP</div>
                        <div class="base-service-note">This is the minimum fee for any service requested</div>
                    </div>

                    <div class="problems-section-title">Common Problems</div>
                    <div class="problem-option selected" data-problem="Component Replacement" data-min="200" data-max="400" onclick="selectProblem(this, 'Component Replacement')">
                        <div class="problem-title">Replace Component</div>
                        <div class="problem-pricing">Base Service Fee 500 PHP + Estimation Fee (200 - 400 PHP)</div>
                        <div class="problem-note">Note: Fee may vary depending on the complexity of the issue and labor hours</div>
                    </div>

                    <div class="problem-option" data-problem="Device Repair" data-min="200" data-max="400" onclick="selectProblem(this, 'Device Repair')">
                        <div class="problem-title">Device Repair</div>
                        <div class="problem-pricing">Base Service Fee 500 PHP + Estimation Fee (200 - 400 PHP)</div>
                        <div class="problem-note">Note: Fee may vary depending on the complexity of the issue and labor hours</div>
                    </div>

                    <div class="problem-option" data-problem="Hardware Restoration" data-min="200" data-max="400" onclick="selectProblem(this, 'Hardware Restoration')">
                        <div class="problem-title">Hardware Restoration</div>
                        <div class="problem-pricing">Base Service Fee 500 PHP + Estimation Fee (200 - 400 PHP)</div>
                        <div class="problem-note">Note: Fee may vary depending on the complexity of the issue and labor hours</div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Select Date</label>
                        <input type="date" class="form-input" id="bookingDate">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Select Time</label>
                        <div class="time-input-group">
                            <input type="number" class="time-input" min="1" max="12" placeholder="00" id="timeHour">
                            <span class="time-separator">:</span>
                            <input type="number" class="time-input" min="0" max="59" placeholder="00" id="timeMinute">
                            <select class="time-period" id="timePeriod">
                                <option value="AM">AM</option>
                                <option value="PM" selected>PM</option>
                            </select>
                        </div>
                        <div class="time-note">Please enter a valid time (HH:MM AM/PM)</div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Problem</label>
                        <div class="problem-display" id="selectedProblem">Component Replacement</div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Payment upon completion</label>
                        <div class="payment-methods">
                            <div class="payment-option selected" data-method="Cash" onclick="selectPayment(this, 'Cash')">
                                <span class="payment-icon"><img src="../img/money.png" alt=""></span>
                                <span>Cash</span>
                            </div>
                            <div class="payment-option" data-method="GCash" onclick="selectPayment(this, 'GCash')">
                                <span class="payment-icon"><img class="gcash" src="../img/gcash.png" alt=""></span>
                                <span>GCash</span>
                            </div>
                            <div class="payment-option" data-method="Maya" onclick="selectPayment(this, 'Maya')">
                                <span class="payment-icon"><img class="maya" src="../img/maya.png" alt=""></span>
                                <span>Maya</span>
                            </div>
                        </div>
                    </div>

                    <!-- user details -->
                    <div class="form-group">
                        <label class="form-label">Your Full Name</label>
                        <input type="text" id="customerName" class="form-input" placeholder="Juan dela Cruz">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Contact Number</label>
                        <input type="tel" id="customerPhone" class="form-input" placeholder="09XXXXXXXXX">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Address</label>
                        <input type="text" id="customerAddress" class="form-input" placeholder="Barangay, City, Province">
                    </div>

                    <button class="book-now-button" id="bookNowBtn">Book Now</button>
                </div>
            </div>
        </div>

        <!-- REVIEW (NEW) Modal -> appears after Book Now, shows a preview/receipt to confirm -->
        <div class="modal-overlay" id="reviewModal">
            <div class="review-content" role="dialog" aria-modal="true" aria-labelledby="reviewTitle">
                <h3 id="reviewTitle" style="margin-bottom:12px;">Review Booking</h3>

                <div class="review-row"><div class="review-title">Repairer</div><div class="review-value" id="rev_repairer">—</div></div>
                <div class="review-row"><div class="review-title">Category</div><div class="review-value" id="rev_category">—</div></div>
                <div class="review-row"><div class="review-title">Problem</div><div class="review-value" id="rev_problem">—</div></div>
                <div class="review-row"><div class="review-title">Date & Time</div><div class="review-value" id="rev_date_time">—</div></div>
                <div class="review-row"><div class="review-title">Payment</div><div class="review-value" id="rev_payment">—</div></div>
                <div class="review-row"><div class="review-title">Estimated Total</div><div class="review-value" id="rev_total">—</div></div>

                <div style="margin-top:10px; color:#6b7280; font-size:13px;">If everything looks good, click Confirm to finalize the booking or Cancel to go back and edit.</div>

                <div class="review-actions">
                    <button class="btn-secondary" onclick="closeModal('reviewModal')">Cancel</button>
                    <button class="btn-primary" onclick="finalizeBooking()">Confirm Booking</button>
                </div>
            </div>
        </div>

        <!-- RECEIPT Modal (final; you already had this in the original) -->
        <div class="modal-overlay" id="receiptModal">
            <div class="receipt-modal-content" role="dialog" aria-modal="true" aria-labelledby="receiptTitle">
                <div class="receipt-header">
                    <div class="receipt-icon">✓</div>
                    <h2 class="receipt-title" id="receiptTitle">Booking Confirmed!</h2>
                    <p class="receipt-subtitle">Your service has been scheduled</p>
                </div>

                <div class="receipt-body">
                    <div class="receipt-section">
                        <div class="receipt-label">Repairer</div>
                        <div class="receipt-repairer-section">
                            <img src="" alt="" class="receipt-repairer-photo" id="receiptRepairerPhoto">
                            <div class="receipt-repairer-info">
                                <div class="receipt-repairer-name" id="receiptRepairerName">Luis Fernando</div>
                                <div class="receipt-repairer-category" id="receiptRepairerCategory">Hardware</div>
                            </div>
                        </div>
                    </div>

                    <div class="receipt-section">
                        <div class="receipt-label">Date & Time</div>
                        <div class="receipt-value" id="receiptDateTime">December 15, 2024 at 02:00 PM</div>
                    </div>

                    <div class="receipt-section">
                        <div class="receipt-label">Service</div>
                        <div class="receipt-value" id="receiptService">Component Replacement</div>
                    </div>

                    <div class="receipt-section">
                        <div class="receipt-label">Contact</div>
                        <div class="receipt-value" id="receiptContact">0917-XXX-XXXX</div>
                    </div>

                    <div class="receipt-section">
                        <div class="receipt-label">Payment Method</div>
                        <div class="receipt-value" id="receiptPayment">Cash</div>
                    </div>

                    <div class="receipt-total-section">
                        <div class="receipt-total-label">Estimated Total</div>
                        <div class="receipt-total-amount" id="receiptTotal">700 - 900 PHP</div>
                    </div>

                    <div class="receipt-note">
                        This is an estimated price range. The final amount may vary depending on the actual work required and materials used.
                    </div>

                    <button class="receipt-button" onclick="closeModal('receiptModal')">Done</button>
                </div>
            </div>
        </div>

    </div>

    <script src="../scripts/customer-booking.js"></script>
    
</body>
</html>
